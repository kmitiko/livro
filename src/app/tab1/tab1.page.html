<ion-header [translucent]="true" class="ion-no-border">
  <ion-toolbar class="new-background-color">
    <ion-buttons slot="end">
      <ion-button (click)="logout()">
        <ion-icon slot="icon-only" name="log-out"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title> Cadastro de Livros </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="preview">
    <ion-avatar (click)="changeImage()">
      <img *ngIf="profile?.imageUrl; else placeholder_avatar;" [src]="profile.imageUrl" alt="">
      <ng-template #placeholder_avatar>
        <div class="fallback">
          <p>Select Avatar</p>
        </div>
      </ng-template>
    </ion-avatar>
  </div> 
  <form
    [formGroup]="livrosFormGroup"
    #livrosFormGroupDirective="ngForm"
    (ngSubmit)="createLivros(livrosFormGroup.value)"
  >
    <ion-list>
      <ion-item>
        <ion-label position="stacked">Nome:</ion-label>
        <ion-input
          formControlName="nome"
          id="nome"
          inputmode="text"
          clearInput="true"
          required
        ></ion-input>
      </ion-item>
      <div
        *ngIf="livrosFormGroup.get('nome')?.hasError('required') && livrosFormGroup.get('nome')?.touched"
      >
        Name shouldn't be empty.
      </div>
      <ion-item>
        <ion-label position="stacked">Autor:</ion-label>
        <ion-input
          formControlName="autor"
          id="autor"
          inputmode="text"
          clearInput="true"
          required
        ></ion-input>
      </ion-item>
      <div
        *ngIf="livrosFormGroup.get('autor')?.hasError('required') && livrosFormGroup.get('autor')?.touched"
      >
        Autor shouldn't be empty.
      </div>
      <ion-item>
        <ion-label position="stacked">Ano:</ion-label>
        <ion-input
          formControlName="ano"
          id="ano"
          inputmode="number"
          clearInput="true"
          required
        ></ion-input>
      </ion-item>
      <div
        *ngIf="livrosFormGroup.get('ano')?.hasError('required') && livrosFormGroup.get('ano')?.touched"
      >
        Ano shouldn't be empty.
      </div>
      <ion-item>
        <ion-label position="stacked">Categoria:</ion-label>
        <ion-select formControlName="categoria">
          <ion-select-option value="Romance">Romance</ion-select-option>
          <ion-select-option value="Ficcao">Ficcao</ion-select-option>
          <ion-select-option value="Contos">Contos</ion-select-option>
          <ion-select-option value="Folclore">Folclore</ion-select-option>
        </ion-select>
      </ion-item>
      <ion-item>
        <ion-label position="stacked">Livraria:</ion-label>
        <ion-input
          formControlName="livraria"
          id="livraria"
          inputmode="text"
          clearInput="true"
          required
        ></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="stacked">Username:</ion-label>
        <ion-input
          formControlName="username"
          id="username"
          inputmode="text"
          clearInput="true"
          required
        ></ion-input>
      </ion-item>
      <div
        *ngIf="livrosFormGroup.get('username')?.hasError('required') && livrosFormGroup.get('username')?.touched"
      >
        Username shouldn't be empty.
      </div>
      <ion-item>
        <ion-label position="stacked">Senha:</ion-label>
        <ion-input
          formControlName="password"
          id="password"
          inputmode="password"
          clearInput="true"
          required
        ></ion-input>
      </ion-item>
      <div
        *ngIf="livrosFormGroup.get('password')?.hasError('required') && livrosFormGroup.get('password')?.touched"
      >
        Password shouldn't be empty.
      </div>
      <ion-item>
        <ion-label position="stacked">Email:</ion-label>
        <ion-input
          formControlName="email"
          id="email"
          inputmode="email"
          clearInput="true"
          required
          email
        ></ion-input>
      </ion-item>
      <div
        *ngIf="livrosFormGroup.get('email')?.hasError('required') && livrosFormGroup.get('email')?.touched"
      >
        Email shouldn't be empty.
      </div>
      <ion-item>
        <ion-label position="stacked">CPF:</ion-label>
        <ion-input
          formControlName="cpf"
          id="cpf"
          inputmode="text"
          clearInput="true"
          required
        ></ion-input>
      </ion-item>
      <div
        *ngIf="livrosFormGroup.get('cpf')?.hasError('required') && livrosFormGroup.get('cpf')?.touched"
      >
        CPF shouldn't be empty.
      </div>

      <ion-item>
        <ion-label position="stacked">CEP:</ion-label>
        <ion-input
          (change)="loadEndereco()"
          formControlName="cep"
          id="cep"
          inputmode="text"
          clearInput="true"
          required
        ></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="stacked">Logradouro:</ion-label>
        <ion-input
          formControlName="logradouro"
          id="logradouro"
          inputmode="text"
          clearInput="true"
          required
          readonly
        ></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="stacked">NÃºmero:</ion-label>
        <ion-input
          formControlName="numero"
          id="numero"
          inputmode="number"
          clearInput="true"
          required
        ></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="stacked">Bairro:</ion-label>
        <ion-input
          formControlName="bairro"
          id="bairro"
          inputmode="text"
          clearInput="true"
          required
          readonly
        ></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="stacked">Cidade:</ion-label>
        <ion-input
          formControlName="localidade"
          id="localidade"
          inputmode="text"
          clearInput="true"
          required
          readonly
        ></ion-input>
      </ion-item>

      <ion-item lines="none">
        <ion-buttons>
          <ion-button
            color="primary"
            type="submit"
            [disabled]="!livrosFormGroup.valid"
            >Salvar</ion-button
          >
        </ion-buttons>
      </ion-item>
    </ion-list>
  </form>
</ion-content>
